FROM rocker/rstudio:4.3.1

ARG user
RUN mkdir -m 777 /home/rstudio/urps25
RUN mkdir -m 777 /home/rstudio/urps25/data
COPY --chmod=444 data/* /home/rstudio/urps25/data/
RUN . /etc/environment && R -e "install.packages(c('lme4', 'haven', 'tidyverse'))"
COPY --chmod=777 "$user"/scripts/* /home/rstudio/urps25/
RUN chown -HR 1000:1000 /home/rstudio/urps25

CMD ["/init"]